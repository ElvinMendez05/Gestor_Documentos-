@* This view is not available, we declained it *@

@model Document_Manager.Web.Models.UploadDocumentViewModel

@{
    ViewData["Title"] = "Subir Documento";
}

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">

<style>
    :root {
        --primary: #667eea;
        --primary-dark: #5a67d8;
        --gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        --shadow-soft: 0 25px 60px rgba(0,0,0,.08);
        --radius: 24px;
    }

    body {
        background: #f6f8fc;
    }

    .upload-wrapper {
        max-width: 820px;
        margin: 70px auto;
        animation: fadeUp .6s ease;
    }

    @@keyframes fadeUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .upload-card {
        background: white;
        border-radius: var(--radius);
        padding: 55px;
        box-shadow: var(--shadow-soft);
    }

    .upload-header h2 {
        font-weight: 700;
        letter-spacing: -0.5px;
    }

    .upload-header p {
        color: #6b7280;
        font-size: .95rem;
    }

    /* DROPZONE */
    .dropzone {
        border: 2px dashed #d1d5db;
        border-radius: var(--radius);
        padding: 80px 40px;
        text-align: center;
        transition: .3s ease;
        cursor: pointer;
        background: #fafbff;
        position: relative;
    }

        .dropzone.dragover {
            border-color: var(--primary);
            background: #eef1ff;
            transform: scale(1.01);
        }

        .dropzone.file-selected {
            border-color: #22c55e;
            background: #f0fdf4;
        }

    .upload-icon {
        font-size: 3rem;
        color: var(--primary);
        margin-bottom: 20px;
        transition: .3s;
    }

    .dropzone.dragover .upload-icon {
        transform: scale(1.15);
    }

    .file-info {
        display: none;
        margin-top: 15px;
        font-weight: 600;
        color: #16a34a;
    }

    .btn-upload {
        background: var(--gradient);
        border: none;
        border-radius: 14px;
        padding: 16px;
        font-weight: 600;
        transition: .3s;
        box-shadow: 0 8px 25px rgba(102,126,234,.4);
    }

        .btn-upload:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 30px rgba(102,126,234,.6);
        }

    .back-link {
        font-weight: 600;
        font-size: .9rem;
        color: #6b7280;
        text-decoration: none;
        transition: .2s;
    }

        .back-link:hover {
            color: var(--primary);
        }

    .validation-message {
        font-size: .85rem;
    }
</style>

<div class="container upload-wrapper">

    <div class="mb-4">
        <a asp-action="Index" class="back-link">
            <i class="bi bi-arrow-left-short"></i> Volver a documentos
        </a>
    </div>

    <div class="upload-card">

        <div class="upload-header text-center mb-5">
            <h2>Subir Documento PDF</h2>
            <p>Arrastra tu archivo o selecciónalo manualmente (Máx 10MB)</p>
        </div>

        <form asp-action="Upload" method="post" enctype="multipart/form-data" id="uploadForm">

            <div class="dropzone" id="dropzone">
                <input type="file" asp-for="File" id="fileInput" hidden accept="application/pdf" />

                <div class="upload-icon">
                    <i class="bi bi-cloud-arrow-up-fill" id="mainIcon"></i>
                </div>

                <h5 class="fw-semibold mb-2" id="uploadText">
                    Haz clic o arrastra tu archivo aquí
                </h5>

                <small class="text-muted">Solo PDF</small>

                <div class="file-info" id="fileInfo">
                    <i class="bi bi-check-circle-fill me-1"></i>
                    <span id="fileName"></span>
                </div>
            </div>

            <div class="text-center mt-3">
                <span asp-validation-for="File" class="text-danger validation-message"></span>
            </div>

            <button type="submit" class="btn btn-upload w-100 mt-4 text-white">
                <i class="bi bi-upload me-2"></i> Subir Documento
            </button>

        </form>
    </div>
</div>

@section Scripts {

    <script>
        const dropzone = document.getElementById("dropzone");
        const fileInput = document.getElementById("fileInput");
        const fileInfo = document.getElementById("fileInfo");
        const fileName = document.getElementById("fileName");
        const uploadText = document.getElementById("uploadText");
        const form = document.getElementById("uploadForm");

        // Click abre el file picker
        dropzone.addEventListener("click", () => fileInput.click());

        // Cuando selecciona archivo
        fileInput.addEventListener("change", handleFile);

        // Drag & Drop
        dropzone.addEventListener("dragover", e => {
            e.preventDefault();
            dropzone.classList.add("dragover");
        });

        dropzone.addEventListener("dragleave", () => {
            dropzone.classList.remove("dragover");
        });

        dropzone.addEventListener("drop", e => {
            e.preventDefault();
            dropzone.classList.remove("dragover");

            if (e.dataTransfer.files.length > 0) {
                fileInput.files = e.dataTransfer.files;
                handleFile();
            }
        });

        function handleFile() {
            const file = fileInput.files[0];
            if (!file) return;

            if (file.type !== "application/pdf") {
                alert("Solo se permiten archivos PDF");
                fileInput.value = "";
                return;
            }

            if (file.size > 10 * 1024 * 1024) {
                alert("El archivo supera los 10MB");
                fileInput.value = "";
                return;
            }

            fileName.textContent = file.name;
            fileInfo.style.display = "block";
            uploadText.style.display = "none";
            dropzone.classList.add("file-selected");
        }
    </script>

}
